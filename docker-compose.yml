version: "3.9"

services:
  godlocal:
    build: .
    ports:
      - "${GODLOCAL_API_PORT:-8000}:8000"
    volumes:
      - .:/app
      - godlocal_data:/app/godlocal_data
    environment:
      - GODLOCAL_MODEL=${GODLOCAL_MODEL:-qwen3:8b}
      - GODLOCAL_API_KEY=${GODLOCAL_API_KEY:-}
      - GODLOCAL_AUTOGENESIS_APPLY=${GODLOCAL_AUTOGENESIS_APPLY:-false}
    depends_on:
      - sandbox
    restart: unless-stopped

  sandbox:
    build:
      context: .
      dockerfile: extensions/sandbox/Dockerfile.sandbox
    image: godlocal-sandbox:latest
    volumes:
      - .:/app:ro
    command: tail -f /dev/null
    restart: unless-stopped

volumes:
  godlocal_data:
